WT_DECLARE_WT_MEMBER(10,JavaScriptConstructor,"WPaintedWidget",function(W,w){w.wtObj=this;var x=this;this.imagePreloaders=[];this.images=[];this.canvas=document.getElementById("c"+w.id);this.repaint=function(){};this.widget=w;this.cancelPreloaders=function(){for(var y=0;y<x.imagePreloaders.length;++y)x.imagePreloaders[y].cancel();x.imagePreloaders=[]}});
WT_DECLARE_WT_MEMBER(11,JavaScriptObject,"gfxUtils",function(){function W(){var g=this;this.path_crisp=function(a){return a.map(function(b){return[Math.floor(b[0])+0.5,Math.floor(b[1])+0.5,b[2]]})};this.transform_mult=function(a,b){if(b.length===2){var e=b[0],h=b[1];return[a[w]*e+a[y]*h+a[E],a[x]*e+a[A]*h+a[F]]}if(b.length===3){if(b[2]===J||b[2]===K)return b.slice(0);e=b[0];h=b[1];return[a[w]*e+a[y]*h+a[E],a[x]*e+a[A]*h+a[F],b[2]]}if(b.length===4){var i,d,c,p;d=g.transform_mult(a,[b[0],b[1]]);e=d[0];
i=d[0];h=d[1];d=d[1];for(c=0;c<3;++c){p=g.transform_mult(a,c==0?[g.rect_left(b),g.rect_bottom(b)]:c==1?[g.rect_right(b),g.rect_top(b)]:[g.rect_right(b),g.rect_bottom(b)]);e=Math.min(e,p[0]);i=Math.max(i,p[0]);h=Math.min(h,p[1]);d=Math.max(d,p[1])}return[e,h,i-e,d-h]}if(b.length===6)return[a[w]*b[w]+a[y]*b[x],a[x]*b[w]+a[A]*b[x],a[w]*b[y]+a[y]*b[A],a[x]*b[y]+a[A]*b[A],a[w]*b[E]+a[y]*b[F]+a[E],a[x]*b[E]+a[A]*b[F]+a[F]];return[]};this.transform_apply=function(a,b){var e=g.transform_mult;return b.map(function(h){return e(a,
h)})};this.transform_det=function(a){return a[w]*a[A]-a[x]*a[y]};this.transform_adjoint=function(a){var b=a[w],e=a[y],h=a[x],i=a[A],d=a[E];a=a[F];return[i,-e,-h,b,a*h-d*i,-(a*b-d*e)]};this.transform_inverted=function(a){var b=g.transform_det(a);if(b!=0){a=g.transform_adjoint(a);return[a[w]/b,a[y]/b,a[x]/b,a[A]/b,a[E]/b,a[F]/b]}else{console.log("inverted(): oops, determinant == 0");return a}};this.transform_assign=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]};this.transform_equal=
function(a,b){return a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]&&a[4]==b[4]&&a[5]==b[5]};this.css_text=function(a){return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")"};this.arcPosition=function(a,b,e,h,i){i=-i/180*Math.PI;return[a+e*Math.cos(i),b+h*Math.sin(i)]};this.pnpoly=function(a,b){var e=false,h=0,i=0,d=a[0];a=a[1];var c,p,o;for(c=0;c<b.length;++c){p=h;o=i;if(b[c][2]===X){o=g.arcPosition(b[c][0],b[c][1],b[c+1][0],b[c+1][1],b[c+2][0]);p=o[0];o=o[1]}else if(b[c][2]===K){o=g.arcPosition(b[c-
2][0],b[c-2][1],b[c-1][0],b[c-1][1],b[c][0]+b[c][1]);p=o[0];o=o[1]}else if(b[c][2]!==J){p=b[c][0];o=b[c][1]}if(b[c][2]!==H)if(i>a!==o>a&&d<(p-h)*(a-i)/(o-i)+h)e=!e;h=p;i=o}return e};this.rect_intersection=function(a,b){a=g.rect_normalized(a);b=g.rect_normalized(b);var e=g.rect_top,h=g.rect_bottom,i=g.rect_left,d=g.rect_right;i=Math.max(i(a),i(b));d=Math.min(d(a),d(b));e=Math.max(e(a),e(b));a=Math.min(h(a),h(b));return[i,e,d-i,a-e]};this.drawRect=function(a,b,e,h){b=g.rect_normalized(b);var i=g.rect_top(b),
d=g.rect_bottom(b),c=g.rect_left(b);b=g.rect_right(b);path=[[c,i,H],[b,i,G],[b,d,G],[c,d,G],[c,i,G]];g.drawPath(a,path,e,h,false)};this.drawPath=function(a,b,e,h,i){function d(m){return m[0]}function c(m){return m[1]}function p(m){return m[2]}var o=0,t=[],q=[],u=[];a.beginPath();b.length>0&&p(b[0])!==H&&a.moveTo(0,0);for(o=0;o<b.length;o++){var k=b[o];switch(p(k)){case H:Math.abs(d(k))<=1048576&&Math.abs(c(k))<=1048576&&a.moveTo(d(k),c(k));break;case G:(function(){var m=o===0?[0,0]:b[o-1];if(!e&&
!i&&h&&(Math.abs(d(m))>1048576||Math.abs(c(m))>1048576||Math.abs(d(k))>1048576||Math.abs(c(k))>1048576)){(function(){function r(M,N,O){return(O-M)/N}function s(M,N,O){return M+O*N}var l=a.wtTransform?a.wtTransform:[1,0,0,1,0,0],B=g.transform_inverted(l),f=g.transform_mult(l,m),n=g.transform_mult(l,k),C=d(n)-d(f),D=c(n)-c(f);l=a.canvas.width+50;var z=a.canvas.height+50,j,v=null,I=j=null;j=null;if(d(f)<-50&&d(n)>-50){j=r(d(f),C,-50);v=[-50,s(c(f),D,j),j]}else if(d(f)>l&&d(n)<l){j=r(d(f),C,l);v=[l,s(c(f),
D,j),j]}else if(d(f)>-50&&d(f)<l)v=[d(f),c(f),0];else return;if(c(f)<-50&&c(n)>-50){j=r(c(f),D,-50);j=[s(d(f),C,j),-50,j]}else if(c(f)>z&&c(n)<z){j=r(c(f),D,z);j=[s(d(f),C,j),z,j]}else if(c(f)>-50&&c(f)<z)j=[d(f),c(f),0];else return;v=v[2]>j[2]?[v[0],v[1]]:[j[0],j[1]];if(!(d(v)<-50||d(v)>l||c(v)<-50||c(v)>z)){if(d(f)<l&&d(n)>l){j=r(d(f),C,l);I=[l,s(c(f),D,j),j]}else if(d(f)>-50&&d(n)<-50){j=r(d(f),C,-50);I=[-50,s(c(f),D,j),j]}else if(d(n)>-50&&d(n)<l)I=[d(n),c(n),1];else return;if(c(f)<z&&c(n)>z){j=
r(c(f),D,z);j=[s(d(f),C,j),z,j]}else if(c(f)>-50&&c(n)<-50){j=r(c(f),D,-50);j=[s(d(f),C,j),-50,j]}else if(d(n)>-50&&c(n)<z)j=[d(n),c(n),1];else return;f=I[2]<j[2]?[I[0],I[1]]:[j[0],j[1]];if(!(d(f)<-50||d(f)>l||c(f)<-50||c(f)>z)){v=g.transform_mult(B,v);f=g.transform_mult(B,f);a.moveTo(v[0],v[1]);a.lineTo(f[0],f[1])}}})();Math.abs(d(k))<=1048576&&Math.abs(c(k))<=1048576&&a.moveTo(d(k),c(k))}else a.lineTo(d(k),c(k))})();break;case aa:t.push(d(k),c(k));break;case ba:t.push(d(k),c(k));break;case P:t.push(d(k),
c(k));a.bezierCurveTo.apply(a,t);t=[];break;case X:q.push(d(k),c(k));break;case J:q.push(d(k));break;case K:(function(){function m(n){return n>360?360:n<-360?-360:n}function r(n){n=n%360;return n<0?n+360:n}function s(n){return n*Math.PI/180}var l=d(k),B=c(k),f=s(r(-l));l=B>=360||B<=-360?f-2*Math.PI*(B>0?1:-1):s(r(-l-m(B)));q.push(f,l,B>0);a.arc.apply(a,q);q=[]})();break;case ca:u.push(d(k),c(k));break;case Q:u.push(d(k),c(k));a.quadraticCurveTo.apply(a,u);u=[];break}}e&&a.fill();h&&a.stroke();i&&
a.clip()};this.drawStencilAlongPath=function(a,b,e,h,i,d){function c(u){return u[0]}function p(u){return u[1]}function o(u){return u[2]}var t=0;for(t=0;t<e.length;t++){var q=e[t];if(!(d&&a.wtClipPath&&!g.pnpoly(q,g.transform_apply(a.wtClipPathTransform,a.wtClipPath))))if(o(q)==H||o(q)==G||o(q)==Q||o(q)==P){q=g.transform_apply([1,0,0,1,c(q),p(q)],b);g.drawPath(a,q,h,i,false)}}};this.drawText=function(a,b,e,h,i){if(!(i&&a.wtClipPath&&!g.pnpoly(i,g.transform_apply(a.wtClipPathTransform,a.wtClipPath)))){var d=
e&S;var c=i=null;switch(e&da){case Y:a.textAlign="left";i=g.rect_left(b);break;case Z:a.textAlign="right";i=g.rect_right(b);break;case $:a.textAlign="center";i=g.rect_center(b).x;break}switch(d){case T:a.textBaseline="top";c=g.rect_top(b);break;case U:a.textBaseline="bottom";c=g.rect_bottom(b);break;case V:a.textBaseline="middle";c=g.rect_center(b).y;break}if(!(i==null||c==null)){b=a.fillStyle;a.fillStyle=a.strokeStyle;a.fillText(h,i,c);a.fillStyle=b}}};this.calcYOffset=function(a,b,e,h){return h===
V?-((b-1)*e/2)+a*e:h===T?a*e:h===U?-(b-1-a)*e:0};this.drawTextOnPath=function(a,b,e,h,i,d,c,p,o){function t(f){return f[0]}function q(f){return f[1]}function u(f){return f[2]}var k=0,m=0;h=g.transform_apply(h,i);for(k=0;k<i.length;k++){if(k>=b.length)break;m=i[k];var r=h[k],s=b[k].split("\n");if(u(m)==H||u(m)==G||u(m)==Q||u(m)==P)if(d==0)for(m=0;m<s.length;m++){var l=g.calcYOffset(m,s.length,c,p&S);g.drawText(a,[e[0]+t(r),e[1]+q(r)+l,e[2],e[3]],p,s[m],o?[t(r),q(r)]:null)}else{l=d*Math.PI/180;m=Math.cos(-l);
l=-Math.sin(-l);var B=-l;a.save();a.transform(m,B,l,m,t(r),q(r));for(m=0;m<s.length;m++){l=g.calcYOffset(m,s.length,c,p&S);g.drawText(a,[e[0],e[1]+l,e[2],e[3]],p,s[m],o?[t(r),q(r)]:null)}a.restore()}}};this.setClipPath=function(a,b,e,h){if(h){a.setTransform.apply(a,e);g.drawPath(a,b,false,false,true);a.setTransform(1,0,0,1,0,0)}a.wtClipPath=b;a.wtClipPathTransform=e};this.removeClipPath=function(a){delete a.wtClipPath;delete a.wtClipPathTransform};this.rect_top=function(a){return a[1]};this.rect_bottom=
function(a){return a[1]+a[3]};this.rect_right=function(a){return a[0]+a[2]};this.rect_left=function(a){return a[0]};this.rect_topleft=function(a){return[a[0],a[1]]};this.rect_topright=function(a){return[a[0]+a[2],a[1]]};this.rect_bottomleft=function(a){return[a[0],a[1]+a[3]]};this.rect_bottomright=function(a){return[a[0]+a[2],a[1]+a[3]]};this.rect_center=function(a){return{x:(2*a[0]+a[2])/2,y:(2*a[1]+a[3])/2}};this.rect_normalized=function(a){var b,e,h;if(a[2]>0){b=a[0];h=a[2]}else{b=a[0]+a[2];h=
-a[2]}if(a[3]>0){e=a[1];a=a[3]}else{e=a[1]+a[3];a=-a[3]}return[b,e,h,a]}}var w=0,x=1,y=2,A=3,E=4,F=5,H=0,G=1,aa=2,ba=3,P=4,ca=5,Q=6,X=7,J=8,K=9,Y=1,Z=2,$=4,T=128,V=512,U=1024,S=112|T|256|V|U|2048,da=Y|Z|$|8;return new W}());
