WT_DECLARE_WT_MEMBER(2,JavaScriptConstructor,"ChartCommon",function(B){function F(a,b,c,d){function e(m){return c?b[m]:b[n-1-m]}function i(m){for(;e(m)[2]===y||e(m)[2]===C;)m--;return m}var j=k;if(d)j=l;var n=b.length;d=Math.floor(n/2);d=i(d);var t=0,r=n,f=false;if(e(0)[j]>a)return c?-1:n;if(e(n-1)[j]<a)return c?n:-1;for(;!f;){var g=d+1;if(g<n&&(e(g)[2]===y||e(g)[2]===C))g+=2;if(e(d)[j]>a){r=d;d=Math.floor((r+t)/2);d=i(d)}else if(e(d)[j]===a)f=true;else if(g<n&&e(g)[j]>a)f=true;else if(g<n&&e(g)[j]===
a){d=g;f=true}else{t=d;d=Math.floor((r+t)/2);d=i(d)}}return c?d:n-1-d}function H(a,b){return b[0][a]<b[b.length-1][a]}var y=2,C=3,k=0,l=1,G=this;B=B.WT.gfxUtils;var z=B.rect_top,A=B.rect_bottom,v=B.rect_left,D=B.rect_right,I=B.transform_mult;this.findClosestPoint=function(a,b,c){var d=k;if(c)d=l;var e=H(d,b);c=F(a,b,e,c);if(c<0)c=0;if(c>=b.length)return[b[b.length-1][k],b[b.length-1][l]];if(c>=b.length)c=b.length-2;if(b[c][d]===a)return[b[c][k],b[c][l]];var i=e?c+1:c-1;if(e&&b[i][2]==y)i+=2;if(!e&&
i<0)return[b[c][k],b[c][l]];if(!e&&i>0&&b[i][2]==C)i-=2;e=Math.abs(a-b[c][d]);a=Math.abs(b[i][d]-a);return e<a?[b[c][k],b[c][l]]:[b[i][k],b[i][l]]};this.minMaxY=function(a,b){b=b?k:l;for(var c=a[0][b],d=a[0][b],e=1;e<a.length;++e)if(a[e][2]!==y&&a[e][2]!==C&&a[e][2]!==5){if(a[e][b]>d)d=a[e][b];if(a[e][b]<c)c=a[e][b]}return[c,d]};this.projection=function(a,b){var c=Math.cos(a);a=Math.sin(a);var d=c*a,e=-b[0]*c-b[1]*a;return[c*c,d,d,a*a,c*e+b[0],a*e+b[1]]};this.distanceSquared=function(a,b){a=[b[k]-
a[k],b[l]-a[l]];return a[k]*a[k]+a[l]*a[l]};this.distanceLessThanRadius=function(a,b,c){return c*c>=G.distanceSquared(a,b)};this.toZoomLevel=function(a){return Math.floor(Math.log(a)/Math.LN2+0.5)+1};this.isPointInRect=function(a,b){var c;if(a.x!==undefined){c=a.x;a=a.y}else{c=a[0];a=a[1]}return c>=v(b)&&c<=D(b)&&a>=z(b)&&a<=A(b)};this.toDisplayCoord=function(a,b,c,d,e){if(c){a=[(a[k]-e[0])/e[2],(a[l]-e[1])/e[3]];d=[d[0]+a[l]*d[2],d[1]+a[k]*d[3]]}else{a=[(a[k]-e[0])/e[2],1-(a[l]-e[1])/e[3]];d=[d[0]+
a[k]*d[2],d[1]+a[l]*d[3]]}return I(b,d)};this.findYRange=function(a,b,c,d,e,i,j,n,t){if(a.length!==0){var r=G.toDisplayCoord([c,0],[1,0,0,1,0,0],e,i,j),f=G.toDisplayCoord([d,0],[1,0,0,1,0,0],e,i,j),g=e?l:k,m=e?k:l,o=H(g,a),h=F(r[g],a,o,e),p=F(f[g],a,o,e),q,s,w=Infinity,x=-Infinity,E=h===p&&h===a.length||h===-1&&p===-1;if(!E){if(o)if(h<0)h=0;else{h++;if(a[h]&&a[h][2]===y)h+=2}else if(h>=a.length-1)h=a.length-2;if(!o&&p<0)p=0;for(q=Math.min(h,p);q<=Math.max(h,p)&&q<a.length;++q)if(a[q][2]!==y&&a[q][2]!==
C){if(a[q][m]<w)w=a[q][m];if(a[q][m]>x)x=a[q][m]}if(o&&h>0||!o&&h<a.length-1){if(o){s=h-1;if(a[s]&&a[s][2]===C)s-=2}else{s=h+1;if(a[s]&&a[s][2]===y)s+=2}q=(r[g]-a[s][g])/(a[h][g]-a[s][g]);h=a[s][m]+q*(a[h][m]-a[s][m]);if(h<w)w=h;if(h>x)x=h}if(o&&p<a.length-1||!o&&p>0){if(o){o=p+1;if(a[o][2]===y)o+=2}else{o=p-1;if(a[o][2]===C)o-=2}q=(f[g]-a[p][g])/(a[o][g]-a[p][g]);h=a[p][m]+q*(a[o][m]-a[p][m]);if(h<w)w=h;if(h>x)x=h}}var u;a=j[2]/(d-c);c=e?2:3;if(!E){u=i[c]/(x-w);u=i[c]/(i[c]/u+20);if(u>t.y[b])u=t.y[b];
if(u<n.y[b])u=n.y[b]}b=e?[r[l]-z(i),!E?(w+x)/2-i[2]/u/2-v(i):0]:[r[k]-v(i),!E?-((w+x)/2+i[3]/u/2-A(i)):0];return{xZoom:a,yZoom:u,panPoint:b}}};this.matchesXAxis=function(a,b,c,d,e){if(e){if(b<z(c)||b>A(c))return false;if((d.side==="min"||d.side==="both")&&a>=v(c)-d.width&&a<=v(c))return true;if((d.side==="max"||d.side==="both")&&a<=D(c)+d.width&&a>=D(c))return true}else{if(a<v(c)||a>D(c))return false;if((d.side==="min"||d.side==="both")&&b<=A(c)+d.width&&b>=A(c))return true;if((d.side==="max"||d.side===
"both")&&b>=z(c)-d.width&&b<=z(c))return true}return false};this.matchYAxis=function(a,b,c,d,e){function i(){return d.length}function j(g){return d[g].side}function n(g){return d[g].width}function t(g){return d[g].minOffset}function r(g){return d[g].maxOffset}if(e){if(a<v(c)||a>D(c))return-1}else if(b<z(c)||b>A(c))return-1;for(var f=0;f<i();++f)if(e)if((j(f)==="min"||j(f)==="both")&&b>=z(c)-t(f)-n(f)&&b<=z(c)-t(f))return f;else{if((j(f)==="max"||j(f)==="both")&&b>=A(c)+r(f)&&b<=A(c)+r(f)+n(f))return f}else if((j(f)===
"min"||j(f)==="both")&&a>=v(c)-t(f)-n(f)&&a<=v(c)-t(f))return f;else if((j(f)==="max"||j(f)==="both")&&a>=D(c)+r(f)&&a<=D(c)+r(f)+n(f))return f;return-1}});
